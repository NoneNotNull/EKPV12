require({cache:{"km/forum/mobile/resource/js/ForumTopicReplayMixin":function(){define(["dojo/_base/declare","dojo/dom-construct"],function(c,a){var b=c("km.forum.mobile.resource.js.ForumTopicReplayMixin",null,{align:"center",count:0,postCreate:function(){this.inherited(arguments);this.subscribe("/km/forum/replaySuccess","changeCount")},_onClick:function(d){this.defer(function(){if(window.replayPost){window.replayPost()}},350)},changeCount:function(){this.count=this.count+1;this.labelNode.innerHTML=this.count},_setCountAttr:function(d){if(d>0){this.labelNode.innerHTML=d}else{this.labelNode.innerHTML=""}}});return b})},"km/forum/mobile/resource/js/ForumCategoryItemListMixin":function(){define(["dojo/_base/declare","mui/list/_TemplateItemListMixin","km/forum/mobile/resource/js/ForumCategoryItemMixin"],function(b,a,c){return b("km.forum.mobile.resource.js.ForumCategoryItemListMixin",[a],{itemRenderer:c})})},"km/forum/mobile/resource/js/ForumTopicItemMixin":function(){define(["dojo/_base/declare","dojo/dom-construct","dojo/dom-class","mui/util","mui/list/item/MixContentItemMixin"],function(c,b,e,a,f){var d=c("km.forum.mobile.resource.js.ForumTopicItemMixin",[f],{replay:0,count:0,isTop:"0",supportCount:0,buildInternalRender:function(){if(this.isTop=="1"){this.buildTopicItemRender()}else{this.inherited(arguments)}},buildTopicItemRender:function(){e.add(this.domNode,"muiMixContentTopItem");var g=b.create("div",{className:"muiMixContentTopInfo"},this.contentNode);b.create("span",{className:"muiTopicHeadSign muiTopicHeadTop",innerHTML:"置顶"},g);var h=b.create("span",{className:"muiMixContentTopCate",innerHTML:"["+this.category+"]"},g);this.connect(h,"click","gotoCate");b.create("span",{className:"muiMixContentTopTitle",innerHTML:this.label},g)},gotoCate:function(g){var h="/km/forum/mobile/index.jsp";var i="/km/forum/km_forum/kmForumTopicIndex.do?method=listChildren&q.categoryId=!{categoryId}&orderby=fdLastPostTime&ordertype=down";h=a.setUrlParameter(h,"moduleName",this.category);h=a.setUrlParameter(h,"filter","1");h=a.setUrlParameter(h,"queryStr",a.setUrlParameter(i,"q.categoryId",this.categoryId));location=a.formatUrl(h)},replayPost:function(g){if(window.replayPost){window.replayPost(this)}},buildBottomRender:function(h){if(this.supportCount){var i=b.create("div",{className:"muiMixContentNum",innerHTML:"<i class='mui mui-praise'></i><span class='muiNumber'>"+(this.supportCount==0?"":this.supportCount)+"</span>"},h)}if(this.replay){var g=b.create("div",{className:"muiMixContentNum",innerHTML:"<i class='mui mui-msg'></i><span class='muiNumber'>"+(this.replay==0?"":this.replay)+"</span>"},h)}if(this.count){b.create("div",{className:"muiMixContentNum",innerHTML:"<i class='mui mui-eyes'></i><span class='muiNumber'>"+(this.count==0?"":this.count)+"</span>"},h,"last")}}});return d})},"km/forum/mobile/resource/js/ForumCategoryBox":function(){define(["dojo/_base/declare","dojo/dom-construct","dojo/dom-class","dojo/request","mui/util","dijit/_WidgetBase"],function(e,c,g,f,b,d){var a=e("km.forum.mobile.resource.js.ForumCategoryBox",[d],{categoryId:null,categoryName:"",baseClass:"muiForumCategory",categoryUrl:"/km/forum/km_forum_cate/kmForumCategory.do?method=categoryDetail&categoryId=!{categoryId}",cateListDataUrl:null,buildRendering:function(){this.inherited(arguments);c.create("i",{className:"mui mui-loading mui-spin"},this.domNode)},postCreate:function(){this.inherited(arguments)},startup:function(){this.inherited(arguments);var h=this;f.post(b.formatUrl(b.urlResolver(this.categoryUrl,this)),{handleAs:"json"}).then(function(i){h.buildCateInfo(i)},function(i){h.buildErrorInfo(i)})},buildCateInfo:function(m){this.buildBaseFrame();if(m.name&&m.name!=""){this.titleNode.innerHTML=m.name}if(m.description&&m.description!=""){c.create("div",{className:"muiForumCateDesc",innerHTML:m.description},this.detailNode)}var j=0;if(m.topicCount){j=m.topicCount}var l=0;if(m.postCount){l=m.postCount}var n=c.create("div",{className:"muiForumCateCount"},this.detailNode);c.create("span",{className:"muiForumCateNum",innerHTML:"发帖数<span>"+j+"</span>"},n);c.create("span",{className:"muiForumCateNum",innerHTML:"回帖数<span>"+l+"</span>"},n);if(m.parentId&&m.parentId!=null){var i=c.create("div",{className:"muiForumCateParent"},this.contentNode);var k=c.create("div",{className:"muiForumCateParentInfo",innerHTML:m.parentName},i);var h=this;this.connect(k,"click",function(){h.gotoParent(m.parentId,m.parentName)})}},gotoParent:function(j,i){var h="/km/forum/mobile/index.jsp";h=b.setUrlParameter(h,"moduleName",i);h=b.setUrlParameter(h,"filter","1");h=b.setUrlParameter(h,"queryStr",b.setUrlParameter(this.cateListDataUrl,"q.categoryId",j));location=b.formatUrl(h)},buildErrorInfo:function(h){this.buildBaseFrame();c.create("div",{className:"muiForumCateDesc",innerHTML:"<span>板块信息获取错误。</span>"},this.detailNode)},buildBaseFrame:function(){c.empty(this.domNode);this.contentNode=c.create("div",{className:"muiForumCateInfo"},this.domNode);this.iconNode=c.create("div",{className:"muiForumCateIcon"},this.contentNode);var h=c.create("span",{className:"muiForumCateImg"},this.iconNode);c.create("i",{className:"mui mui-evaluation"},h);this.detailNode=c.create("div",{className:"muiForumCateContent"},this.contentNode);this.titleNode=c.create("div",{className:"muiForumCateTitle",innerHTML:this.categoryName},this.detailNode)}});return a})},"km/forum/mobile/resource/js/ForumCategoryItemMixin":function(){define(["dojo/_base/declare","dojo/dom-class","mui/iconUtils","mui/simplecategory/SimpleCategoryItemMixin"],function(a,e,c,b){var d=a("km.forum.mobile.resource.js.ForumCategoryItemMixin",[b],{buildRendering:function(){this.inherited(arguments);this.type=this.nodeType=="CATEGORY"?window.SIMPLE_CATEGORY_TYPE_CATEGORY:1},showMore:function(){return true},showSelect:function(){if(this.type==window.SIMPLE_CATEGORY_TYPE_CATEGORY){return true}return false}});return d})},"km/forum/mobile/resource/js/ForumCategoryList":function(){define(["dojo/_base/declare","mui/category/CategoryList"],function(b,a){return b("km.forum.mobile.resource.js.ForumCategoryList",[a],{modelName:null,dataUrl:"/km/forum/mobile/kmForumMobileCategory.do?method=cateList&categoryId=!{parentId}&modelName=!{modelName}&authType=!{authType}"})})},"km/forum/mobile/resource/js/ForumPostItemListMixin":function(){define(["dojo/_base/declare","mui/list/_TemplateItemListMixin","km/forum/mobile/resource/js/ForumPostItemMixin"],function(b,c,a){return b("km.forum.mobile.resource.js.ForumPostItemListMixin",[c],{rowsize:10,itemTemplateString:null,itemRenderer:a})})},"km/forum/mobile/resource/js/ForumTopicHead":function(){define(["dojo/_base/declare","dojo/dom-construct","dojo/dom-class","dojo/touch","dijit/_WidgetBase","mui/util"],function(c,b,f,g,e,a){var d=c("km.forum.mobile.resource.js.ForumTopicHead",[e],{created:"",count:0,replyCount:0,label:null,cateName:null,cateId:null,top:false,hot:false,pinked:false,closed:false,baseClass:"muiTopicHead",buildRendering:function(){this.inherited(arguments);this.contendNode=b.create("div",{className:"muiTopicContent"},this.domNode);this.buildInternalRender()},postCreate:function(){this.inherited(arguments);this.subscribe("/km/forum/replaySuccess","changeReplayCount")},startup:function(){this.inherited(arguments)},buildInternalRender:function(){this.topNode=b.create("div",{className:"muiTopicHeadT"},this.contendNode);if(this.label){var h=b.create("span",{className:"muiTopicHeadTitle"},this.topNode);if(this.top){b.create("span",{className:"muiTopicHeadSign muiTopicHeadTop",innerHTML:"顶"},h)}if(this.hot){b.create("i",{className:"mui-hotPost mui"},h)}if(this.pinked){b.create("span",{className:"muiTopicHeadSign muiTopicHeadPink",innerHTML:"精"},h)}if(this.closed){b.create("i",{className:"mui mui-todo_lock"},h)}b.create("span",{innerHTML:this.label},h)}var i=b.create("div",{className:"muiTopicHeadB"},this.contendNode);this.bottomNode=b.create("div",{className:"muiTopicHeadSummary"},i);if(this.cateName){var j=b.create("div",{className:"muiTopicHeadCate",innerHTML:"<span>"+this.cateName+"&nbsp;<i class='mui mui-Cforward'></i></span>"},this.bottomNode);this.connect(j,g.press,"gotoCate")}var l=b.create("div",{className:"muiTopicHeadNumInfo"},this.bottomNode);var k=b.create("span",{className:"muiTopicHeadNum mui mui-msg"},l);this.replayNode=b.create("span",{innerHTML:this.replyCount},k);b.create("span",{className:"muiTopicHeadNum mui mui-eyes",innerHTML:"<span>"+this.count+"</span>"},l)},changeReplayCount:function(){if(this.replayNode){this.replayNode.innerHTML="<span>"+(this.replyCount+1)+"</span>"}},gotoCate:function(h){var i="/km/forum/mobile/index.jsp";var j="/km/forum/km_forum/kmForumTopicIndex.do?method=listChildren&q.categoryId=!{cateId}&orderby=fdLastPostTime&ordertype=down";i=a.setUrlParameter(i,"moduleName",this.cateName);i=a.setUrlParameter(i,"filter","1");i=a.setUrlParameter(i,"queryStr",a.setUrlParameter(j,"q.categoryId",this.cateId));location=a.formatUrl(i)}});return d})},"km/forum/mobile/resource/js/ForumTopicCreate":function(){define(["dojo/_base/declare","dojo/_base/array","dojo/query","dojo/request","dijit/registry","mui/util","mui/device/device","mui/tabbar/CreateButton","mui/dialog/Tip","km/forum/mobile/resource/js/ForumCategoryMixin","mui/form/editor/EditorUtil","dojo/text!km/forum/mobile/resource/js/layout.html"],function(d,h,i,c,a,g,b,f,l,m,j,k){var e=d("km.forum.mobile.resource.js.ForumTopicCreate",[f,m],{modelName:"com.landray.kmss.km.forum.model.KmForumCategory",cateId:null,_createCateId:null,saveUrl:"/km/forum/mobile/kmForumPost.do?method=save",categoryDetailUrl:"/km/forum/km_forum_cate/kmForumCategory.do?method=categoryDetail&categoryId=!{cateId}&base=1",startup:function(){this.inherited(arguments);if(this.cateId){var n=this;c.post(g.formatUrl(g.urlResolver(this.categoryDetailUrl,this)),{handleAs:"json"}).then(function(o){if(o.parentId==null||o.parentId==""){n._createCateId=null}else{n._createCateId=n.cateId}},function(o){n._createCateId=null})}},_onClick:function(n){if(this._createCateId!=null&&this._createCateId!=""){this.curIds=this._createCateId;this.newTopic()}else{this.inherited(arguments)}},afterSelectCate:function(n){this.newTopic()},newTopic:function(){var n=this;var o=[];if(window.validateCreateTopic){o.push(window.validateCreateTopic)}j.popup(this.saveUrl,{name:"docContent",subject:"docSubject",layout:k,placeholder:"发帖",validates:o,data:{fdIsAnonymous:"false",fdPdaType:b.getClientType(),fdForumId:this.curIds,isNormal:"1"}},function(p){if(p.status==200){l.success({text:"操作成功"})}else{l.fail({text:"操作失败"})}if(window.refreshList){window.refreshList()}})}});return e})},"km/forum/mobile/resource/js/ForumPostItemMixin":function(){define(["dojo/_base/declare","dojo/dom-construct","mui/util","dojo/html","dojo/touch","dojo/query","dijit/_WidgetBase","mui/rtf/RtfResize","mui/iconUtils","mui/dialog/OperaTip","dojo/dom-class","sys/praise/mobile/import/js/_PraiseInformationMixin"],function(g,c,i,h,f,k,e,d,b,a,l,j){var m=g("km.forum.mobile.resource.js.ForumPostItemMixin",[e,j],{fdId:null,rowIndex:null,tmplURL:null,icon:null,creator:null,created:null,floor:null,score:null,extendInfo:null,from:"",optFlag:null,content:null,parentId:null,parentPoster:null,parentCreated:null,parentSummary:null,baseClass:"muiForumPostItem",buildRendering:function(){this.inherited(arguments);this.contentNode=c.create("div",{className:"muiForumPostContent"},this.domNode);this.buildItem()},buildItem:function(){var n=c.create("div",{className:"muiPostContentArea"},this.contentNode);this.contentTop=c.create("div",{className:"muiPostContentT"},n);this.buildTop();this.contentMiddle=c.create("div",{className:"muiPostContentC"},n);this.buildMiddle();if(this.optFlag){this.contentBottom=c.create("div",{className:"muiPostContentB"},n);this.buildBootom()}},buildTop:function(){var p=c.create("div",{className:"muiPostHead"},this.contentTop);var n=c.create("div",{className:"muiPostIcon"},p);if(this.icon){b.setIcon(this.icon,null,this._posterIcon,null,n)}var q=c.create("div",{className:"muiPostCreate"},p);var o="";if(this.creator){o=o+this.creator}if(this.score){o=o+'<span class="muiPostFloor muiPostFloorLevel">'+this.score+"</span>"}if(this.extendInfo){o=o+'<span class="muiPostFloor muiPostFloor1">'+this.extendInfo+"</span>"}if(o!=""){c.create("div",{className:"muiPostCreator",innerHTML:o},q)}o="";if(this.created){o=o+'<i class="mui mui-time"></i><span>'+this.created+"</span>"}if(this.from){o=o+"<span>"+this.from+"</span>"}if(o!=""){c.create("div",{className:"muiPostCreated",innerHTML:o},q)}if(this.floor&&this.floor!=null){o="";var r=parseInt(this.floor,10);switch(r){case 1:break;case 2:o='<span class="muiPostFloor muiPostFloor2">沙发</span>';break;case 3:o='<span class="muiPostFloor muiPostFloor3">板凳</span>';break;case 4:o='<span class="muiPostFloor muiPostFloor4">地板</span>';break;default:o='<span class="muiPostFloorX">'+(r-1)+"&nbsp;楼</span>";break}if(o!=""){c.create("div",{className:"muiPostFloorInfo",innerHTML:o},p)}}},buildMiddle:function(){if(this.parentId){var p=c.create("div",{className:"muiPostParent"},this.contentMiddle);c.create("div",{className:"muiPostParentV"},p);var n=c.create("div",{className:"muiPostParentC"},p);var o="";if(this.parentPoster){o=o+"<span>"+this.parentPoster+"</span>"}if(this.parentCreated){o=o+"<span>发表于</span><span>"+this.parentCreated+"</span>"}if(o!=""){c.create("div",{className:"muiPostParentReplay",innerHTML:o},n)}if(this.parentSummary){o='<span class="muiPostQuoteL"><i class="mui mui-quoteL"></i></span>';o=o+this.parentSummary+'<span class="muiPostQuoteR"><i class="mui mui-quoteR"></i></span>';if(o!=""){c.create("div",{className:"muiPostParentContent",innerHTML:o},n)}}}if(this.content){c.create("div",{className:"muiFieldRtf",id:"__RTF_"+this.fdId+"_docContent",innerHTML:this.content},this.contentMiddle)}if(this.tmplURL){this.attachmentDiv=c.create("div",{className:"muiPostAttchment"},this.contentMiddle)}},buildBootom:function(){var n=c.create("div",{className:"muiPostContentOpt"},this.contentBottom);var p=c.create("div",{className:"muiTopicReplyOperation",innerHTML:'<span class="l"></span><span class="f"></span><i class="mui mui-more"></i>'},n);var o=this;this.connect(p,f.press,function(){this.defer(function(){this.expandFun(p)},350)})},expandFun:function(o){if(!this.dialog||this.dialog.domNode==null){var n=this;this.modelId=this.fdId;this.modelName="com.landray.kmss.km.forum.model.KmForumPost";this.dialog=a.tip({refNode:o,operas:[{icon:"muiForumPraiseSign mui-praise",text:"赞",func:function(p){n.parisePost(p)}},{icon:"mui-msg",text:"回复",func:function(){n.replayPost()}}]});this.defer(function(){if(this.hasPraised){this.hasPraised()}},220)}},postCreate:function(){this.inherited(arguments)},startup:function(){this.inherited(arguments);if(this.tmplURL){var n=this;require(["dojo/text!"+i.formatUrl(i.urlResolver(this.tmplURL,this))],function(p){c.empty(n.attachmentDiv);var o=new h._ContentSetter({node:n.attachmentDiv,parseContent:true,cleanContent:true});o.set(p);o.parseDeferred.then(function(q){n.parseResults=q;n.addtionOpt()});o.tearDown()})}},parisePost:function(n){this.doPraised()},togglePraised:function(q){var o=k(".muiDialogOperationTip .muiDialogOperationButton .muiForumPraiseSign");if(o.length>0){var p="mui-scaleX mui-praise-on";var n="mui-scaleX mui-praise";if(this.isPraised){l.replace(o[0],p,n)}else{l.replace(o[0],n,p)}this.defer(function(){l.remove(o[0],"mui-scaleX")},300)}},replayPost:function(n){if(window.replayPost){if(this.rowIndex==0){window.replayPost()}else{window.replayPost(this)}}},addtionOpt:function(){var n="#__RTF_"+this.fdId+"_docContent";var o=k(n,this.domNode);if(o.length>0){new d({containerNode:o[0]})}}});return m})},"km/forum/mobile/resource/js/ForumTopicItemListMixin":function(){define(["dojo/_base/declare","mui/list/_TemplateItemListMixin","km/forum/mobile/resource/js/ForumTopicItemMixin"],function(a,b,c){return a("km.forum.mobile.resource.js.ForumTopicItemListMixin",[b],{itemTemplateString:null,itemRenderer:c})})},"km/forum/mobile/resource/js/ForumTopicParseMixin":function(){define(["dojo/_base/declare","dojo/dom-construct","sys/praise/mobile/import/js/_PraiseTabBarButtonMixin"],function(c,a,d){var b=c("km.forum.mobile.resource.js.ForumTopicParseMixin",[d],{togglePraised:function(e){this.inherited(arguments);if(!e){if(this.isPraised){this._set("count",this.count+1)}else{this._set("count",this.count-1)}this._reDrawLabel()}},_reDrawLabel:function(){if(this.labelNode){if(this.count>0){this.labelNode.innerHTML=this.count}else{this.labelNode.innerHTML=""}}},_setCountAttr:function(e){this._set("count",e);this._reDrawLabel()}});return b})},"km/forum/mobile/resource/js/ForumCategoryMixin":function(){define(["dojo/_base/declare"],function(b){window.SIMPLE_CATEGORY_TYPE_CATEGORY=0;var a=b("km.forum.mobile.resource.js.ForumCategoryMixin",null,{type:SIMPLE_CATEGORY_TYPE_CATEGORY,modelName:null,authType:"02",isMul:false,templURL:"km/forum/mobile/category/category_sgl.jsp?modelName=!{modelName}&authType=!{authType}",_setIsMulAttr:function(c){this._set("isMul",c)}});return a})}}});