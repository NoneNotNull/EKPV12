(function(b){$.fx.off=false;Pda.ps={};var a=navigator.userAgent;Pda.ps.Util={browser:{version:(a.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[])[1],webkit:/webkit/i.test(a),isAndroid:/android/i.test(a),isiOS:/like Mac OS/i.test(a)},coalesce:function(){var c;for(c=0;c<arguments.length;c++){if(!this.isNothing(arguments[c])){return arguments[c]}}return null},extend:function(c,d,e){if(this.isNothing(e)){e=true}if(c&&d&&this.isObject(d)){for(var f in d){if(e){c[f]=d[f]}else{if(typeof c[f]=="undefined"){c[f]=d[f]}}}}},swapArrayElements:function(c,f,e){var d=c[f];c[f]=c[e];c[e]=d},isObject:function(c){return typeof c=="object"},isNothing:function(c){if(typeof c==="undefined"||c===null){return true}return false},isString:function(c){return typeof c=="string"}}})(window);(function(a,b){b.extend(b,{DOM:{resetTranslate:function(c){$(c).css({webkitTransform:"translate3d(0px, 0px, 0px)"})},createElement:function(e,d,f){var c=$("<"+e+"></"+e+">");c.attr(d);c.append(f);return c[0]},appendChild:function(c,d){$(d).append(c)},appendToBody:function(c){$("body").append(c)},removeChildren:function(c){$(c).empty()},getAttribute:function(d,c){return $(d).attr(c)},setAttribute:function(d,c,e){$(d).attr(c,e)},removeAttribute:function(d,c){$(d).removeAttr(c)},addClass:function(d,c){$(d).addClass(c)},removeClass:function(d,c){$(d).removeClass(c)},setStyle:function(d,c,e){if(b.isObject(c)){$(d).css(c)}else{$(d).css(c,e)}},hide:function(c){$(c).hide()},show:function(c){$(c).show()},width:function(c,d){if(!b.isNothing(d)){$(c).width(d)}return Math.max($(c).width(),parseInt($(c).css("width")))},height:function(c,d){if(!b.isNothing(d)){$(c).height(d)}return Math.max($(c).height(),parseInt($(c).css("height")))},bodyWidth:function(){return $(document.body).width()},bodyHeight:function(){return $(document.body).height()},windowHeight:function(){if(!a.innerHeight){return $(a).height()}return a.innerHeight},windowScrollTop:function(){if(!a.pageYOffset){return $(a).scrollTop()}return a.pageYOffset},addListener:function(d,c,e){$(d).bind(c,e)},removeListener:function(d,c,e){$(d).unbind(c,e)},getTouchEvent:function(c){return c.originalEvent||c}}})})(window,Pda.ps.Util);(function(a,b){b.extend(b,{Animation:{fadeIn:function(d,c,e,f){c=b.coalesce(c,1);e=b.coalesce(e,500);$(d).animate({opacity:c},e,"linear",f)},fadeOut:function(c,d,e){if(b.isNothing(d)){d=500}$(c).animate({opacity:0},d,"linear",e)},slideBy:function(c,h,d,f,k){if(b.isNothing(f)){f=500}var g,j=$(c).position(),e=j.left,i=j.top;g={left:e+h+"px",top:"+="+d+"px"};$(c).animate(g,f,"ease",k)}}})})(window,Pda.ps.Util);(function(){Pda.ps.EventClass=SimpleClass.extend({_listeners:null,init:function(){this._listeners={}},addListener:function(a,b){if(typeof this._listeners[a]==="undefined"){this._listeners[a]=[]}this._listeners[a].push(b)},dispatchEvent:function(d){if(typeof d=="string"){d={type:d}}if(!d.target){d.target=this}if(this._listeners[d.type] instanceof Array){var c=this._listeners[d.type];for(var b=0,a=c.length;b<a;b++){c[b].call(this,d)}}},removeListener:function(d,e){if(this._listeners[d] instanceof Array){var c=this._listeners[d];for(var b=0,a=c.length;b<a;b++){if(c[b]===e){c.splice(b,1);break}}}}})})();(function(a,b){Pda.ps.ElementClass=Pda.ps.EventClass.extend({el:null,settings:null,isHidden:null,fadeInHandler:null,fadeOutHandler:null,init:function(c){this._super();this.settings={opacity:1,fadeInSpeed:250,fadeOutSpeed:500};b.extend(this.settings,c);this.fadeInHandler=this.postFadeIn.bind(this);this.fadeOutHandler=this.postFadeOut.bind(this);this.isHidden=true},resetPosition:function(){},show:function(){b.DOM.setStyle(this.el,"opacity",this.settings.opacity);b.DOM.show(this.el);this.postShow()},postShow:function(){this.isHidden=false;this.addListeners();this.dispatchEvent(Pda.ps.ElementClass.EventTypes.onShow)},fadeIn:function(){b.DOM.setStyle(this.el,"opacity",0);this.fadeInFromCurrentOpacity()},fadeInFromCurrentOpacity:function(){this.isHidden=false;b.DOM.show(this.el);b.Animation.fadeIn(this.el,this.settings.opacity,this.settings.fadeInSpeed,this.fadeInHandler)},postFadeIn:function(c){if(this.isHidden){return}this.addListeners();this.dispatchEvent(Pda.ps.ElementClass.EventTypes.onFadeIn)},hide:function(){b.DOM.hide(this.el);this.postHide()},postHide:function(){this.isHidden=true;this.removeListeners();this.dispatchEvent(Pda.ps.ElementClass.EventTypes.onHide)},fadeOut:function(){this.isHidden=true;b.Animation.fadeOut(this.el,this.settings.fadeOutSpeed,this.fadeOutHandler)},postFadeOut:function(c){if(!this.isHidden){return}b.DOM.hide(this.el);this.removeListeners();this.dispatchEvent(Pda.ps.ElementClass.EventTypes.onFadeOut)},addListeners:function(){},removeListeners:function(){}});Pda.ps.ElementClass.EventTypes={onShow:"onShow",onHide:"onHide",onClick:"onClick",onFadeIn:"onFadeIn",onFadeOut:"onFadeOut"}})(window,Pda.ps.Util);(function(a,b){Pda.ps.FullSizeImageClass=Pda.ps.EventClass.extend({el:null,index:null,naturalWidth:null,naturalHeight:null,src:null,caption:null,metaData:null,scaleMethod:null,isLandscape:null,isLoading:null,hasLoaded:null,loadEventHandler:null,init:function(f,d,g,e,c){this._super();this.index=f;this.naturalWidth=0;this.naturalHeight=0;this.src=g;this.caption=e;this.metaData=b.coalesce(c,{});this.isLandscape=false;this.isLoading=false;this.hasLoaded=false;this.scaleMethod=d;this.loadEventHandler=this.onLoad.bind(this)},load:function(){this.isLoading=true;this.el=new Image();b.DOM.addClass(this.el,"ps-full-size-image");this.el.onload=this.loadEventHandler;this.el.src=this.src},onLoad:function(){this.naturalWidth=b.coalesce(this.el.naturalWidth,this.el.width);this.naturalHeight=b.coalesce(this.el.naturalHeight,this.el.height);this.isLandscape=(this.naturalWidth>this.naturalHeight);this.isLoading=false;this.hasLoaded=true;this.dispatchEvent(Pda.ps.FullSizeImageClass.EventTypes.onLoad)}});Pda.ps.FullSizeImageClass.EventTypes={onLoad:"onLoad"}})(window,Pda.ps.Util);(function(a,b){Pda.ps.DocumentOverlayClass=Pda.ps.ElementClass.extend({init:function(c){this.settings={zIndex:1000};b.extend(this.settings,c);this._super(c);this.el=b.DOM.createElement("div",{"class":Pda.ps.DocumentOverlayClass.CssClasses.documentOverlay},"");b.DOM.setStyle(this.el,{left:0,position:"absolute",zIndex:this.settings.zIndex,top:0});b.DOM.hide(this.el);b.DOM.appendToBody(this.el)},resetPosition:function(){b.DOM.width(this.el,b.DOM.bodyWidth());b.DOM.height(this.el,b.DOM.bodyHeight())}});Pda.ps.DocumentOverlayClass.CssClasses={documentOverlay:"ps-document-overlay"}})(window,Pda.ps.Util);(function(a,b){Pda.ps.ViewportClass=Pda.ps.ElementClass.extend({touchStartPoint:null,touchStartTime:null,touchStartHandler:null,touchMoveHandler:null,touchEndHandler:null,isGesture:null,init:function(c){this.settings={swipeThreshold:500,swipeTimeThreshold:250,zIndex:1000};b.extend(this.settings,c);this._super(this.settings);this.touchStartPoint={x:0,y:0};this.touchStartHandler=this.onTouchStart.bind(this);this.touchMoveHandler=this.onTouchMove.bind(this);this.touchEndHandler=this.onTouchEnd.bind(this);this.el=b.DOM.createElement("div",{"class":Pda.ps.ViewportClass.CssClasses.viewport,"data-role":"dialog"},"");b.DOM.setStyle(this.el,{position:"absolute",left:0,zIndex:this.settings.zIndex,overflow:"hidden"});b.DOM.hide(this.el);b.DOM.appendToBody(this.el)},resetPosition:function(){b.DOM.setStyle(this.el,{top:b.DOM.windowScrollTop()+"px"});b.DOM.width(this.el,b.DOM.bodyWidth());b.DOM.height(this.el,b.DOM.windowHeight())},addListeners:function(){b.DOM.addListener(this.el,"touchstart",this.touchStartHandler);b.DOM.addListener(this.el,"touchmove",this.touchMoveHandler);b.DOM.addListener(this.el,"touchend",this.touchEndHandler)},removeListeners:function(){b.DOM.removeListener(this.el,"touchstart",this.touchStartHandler);b.DOM.removeListener(this.el,"touchmove",this.touchMoveHandler);b.DOM.removeListener(this.el,"touchend",this.touchEndHandler)},getTouchPoint:function(c){return{x:c[0].pageX,y:c[0].pageY}},onTouchStart:function(f){f.preventDefault();var c=b.DOM.getTouchEvent(f),d=c.touches;if(d.length>1){this.isGesture=true;return}this.dispatchEvent({type:Pda.ps.ViewportClass.EventTypes.onTouch,target:this,action:Pda.ps.ViewportClass.Actions.touchStart,point:this.getTouchPoint(d)});this.touchStartTime=new Date();this.isGesture=false;this.touchStartPoint=this.getTouchPoint(d)},onTouchMove:function(f){f.preventDefault();if(this.isGesture){return}var c=b.DOM.getTouchEvent(f),d=c.touches;this.dispatchEvent({type:Pda.ps.ViewportClass.EventTypes.onTouch,target:this,action:Pda.ps.ViewportClass.Actions.touchMove,point:this.getTouchPoint(d)})},onTouchEnd:function(g){g.preventDefault();if(this.isGesture){return}var c=b.DOM.getTouchEvent(g),f=(!b.isNothing(c.changedTouches))?c.changedTouches:c.touches,d=this.getTouchPoint(f);this.dispatchEvent({type:Pda.ps.ViewportClass.EventTypes.onTouch,target:this,action:Pda.ps.ViewportClass.Actions.touchEnd,point:d});this.fireTouchEvent(this.touchStartPoint,d)},fireTouchEvent:function(f,d){var g;var c=new Date(),e=c-this.touchStartTime;if(e>this.settings.swipeTimeThreshold){return}var h=d.x-f.x;if(Math.abs(h)>=this.settings.swipeThreshold){if(h<0){g=Pda.ps.ViewportClass.Actions.swipeLeft}else{g=Pda.ps.ViewportClass.Actions.swipeRight}}else{g=Pda.ps.ViewportClass.Actions.click}if(b.isNothing(g)){return}this.dispatchEvent({type:Pda.ps.ViewportClass.EventTypes.onTouch,target:this,action:g})}});Pda.ps.ViewportClass.CssClasses={viewport:"ps-viewport"};Pda.ps.ViewportClass.Actions={click:"click",swipeLeft:"swipeLeft",swipeRight:"swipeRight",touchStart:"touchStart",touchMove:"touchMove",touchEnd:"touchEnd"};Pda.ps.ViewportClass.EventTypes={onTouch:"onTouch"}})(window,Pda.ps.Util);(function(b,c,a){Pda.ps.SliderItemClass=Pda.ps.EventClass.extend({el:null,imageContainerEl:null,imageEl:null,parentEl:null,fullSizeImage:null,fullSizeImageLoadEventHandler:null,savedImageWidth:null,savedImageHeight:null,init:function(d){this._super();this.parentEl=d;this.fullSizeImageLoadEventHandler=this.onFullSizeImageLoad.bind(this);this.el=c.DOM.createElement("div",{"class":Pda.ps.SliderItemClass.CssClasses.item+" "+Pda.ps.SliderItemClass.CssClasses.loading},"");c.DOM.setStyle(this.el,{position:"absolute",overflow:"hidden",top:0});c.DOM.resetTranslate(this.el);c.DOM.appendChild(this.el,this.parentEl);this.imageContainerEl=c.DOM.createElement("div","aa");c.DOM.setStyle(this.imageContainerEl,{position:"absolute",overflow:"hidden",top:0,left:0});c.DOM.appendChild(this.imageContainerEl,this.el);this.imageEl=new Image();c.DOM.setStyle(this.imageEl,{display:"block",position:"absolute",margin:0,padding:0});c.DOM.hide(this.imageEl);c.DOM.appendChild(this.imageEl,this.imageContainerEl)},resetPosition:function(e,d,f){c.DOM.width(this.el,e);c.DOM.height(this.el,d);c.DOM.setStyle(this.el,"left",f+"px");c.DOM.width(this.imageContainerEl,e);c.DOM.height(this.imageContainerEl,d);this.resetImagePosition()},resetImagePosition:function(){if(c.isNothing(this.fullSizeImage)){return}var k=c.DOM.getAttribute(this.imageEl,"src");var j,i,d,e,h,g=c.DOM.width(this.el),f=c.DOM.height(this.el);if(this.fullSizeImage.isLandscape){j=g/this.fullSizeImage.naturalWidth}else{j=f/this.fullSizeImage.naturalHeight}i=Math.round(this.fullSizeImage.naturalWidth*j);d=Math.round(this.fullSizeImage.naturalHeight*j);if(this.fullSizeImage.scaleMethod==="fit"){j=1;if(i>g){j=g/i}else{if(d>f){j=f/d}}if(j!==1){i=Math.round(i*j);d=Math.round(d*j)}}e=((f-d)/2)+"px";h=((g-i)/2)+"px";c.DOM.width(this.imageEl,i);c.DOM.height(this.imageEl,d);c.DOM.setStyle(this.imageEl,{top:e,left:h});c.DOM.show(this.imageEl);this.savedImageWidth=i;this.savedImageHeight=d},setFullSizeImage:function(d){this.fullSizeImage=d;c.DOM.removeClass(this.el,Pda.ps.SliderItemClass.CssClasses.loading);c.DOM.removeClass(this.el,Pda.ps.SliderItemClass.CssClasses.imageError);if(c.isNothing(this.fullSizeImage)){this.fullSizeImage=null;c.DOM.addClass(this.el,Pda.ps.SliderItemClass.CssClasses.imageError);this.hideImage();return}if(!this.fullSizeImage.hasLoaded){c.DOM.addClass(this.el,Pda.ps.SliderItemClass.CssClasses.loading);this.hideImage();if(!this.fullSizeImage.isLoading){this.fullSizeImage.addListener(a.EventTypes.onLoad,this.fullSizeImageLoadEventHandler);this.fullSizeImage.load()}return}c.DOM.setAttribute(this.imageEl,"src",this.fullSizeImage.src);this.resetImagePosition();this.dispatchEvent(Pda.ps.SliderItemClass.EventTypes.onFullSizeImageDisplay)},onFullSizeImageLoad:function(d){d.target.removeListener(a.EventTypes.onLoad,this.fullSizeImageLoadEventHandler);if(c.isNothing(this.fullSizeImage)||d.target.index!==this.fullSizeImage.index){this.dispatchEvent({type:Pda.ps.SliderItemClass.EventTypes.onFullSizeImageLoadAnomaly,target:this,fullSizeImage:d.target})}else{this.setFullSizeImage(d.target)}},hideImage:function(){c.DOM.removeAttribute(this.imageEl,"src");c.DOM.hide(this.imageEl)}});Pda.ps.SliderItemClass.CssClasses={item:"ps-slider-item",loading:"ps-slider-item-loading",imageError:"ps-slider-item-image-error"};Pda.ps.SliderItemClass.EventTypes={onFullSizeImageDisplay:"onFullSizeImageDisplay",onFullSizeImageLoadAnomaly:"onFullSizeImageLoadAnomaly"}})(window,Pda.ps.Util,Pda.ps.FullSizeImageClass);(function(a,c,b){Pda.ps.SliderClass=Pda.ps.ElementClass.extend({parentEl:null,parentElWidth:null,parentElHeight:null,items:null,scaleEl:null,lastScaleValue:null,previousItem:null,currentItem:null,nextItem:null,hasBounced:null,lastShowAction:null,bounceSlideBy:null,showNextEndEventHandler:null,showPreviousEndEventHandler:null,bounceStepOneEventHandler:null,bounceStepTwoEventHandler:null,sliderFullSizeImageLoadAnomalyEventHandler:null,init:function(d,e){this.settings={slideSpeed:250};c.extend(this.settings,d);this._super(this.settings);this.parentEl=e;this.hasBounced=false;this.showNextEndEventHandler=this.onShowNextEnd.bind(this);this.showPreviousEndEventHandler=this.onShowPreviousEnd.bind(this);this.bounceStepOneEventHandler=this.onBounceStepOne.bind(this);this.bounceStepTwoEventHandler=this.onBounceStepTwo.bind(this);this.sliderFullSizeImageLoadAnomalyEventHandler=this.onSliderFullSizeImageLoadAnomaly.bind(this);this.el=c.DOM.createElement("div",{"class":"ps-slider"},"");c.DOM.setStyle(this.el,{position:"absolute",top:0});c.DOM.hide(this.el);c.DOM.appendChild(this.el,e);this.items=[];this.items.push(new b(this.el));this.items.push(new b(this.el));this.items.push(new b(this.el));this.previousItem=this.items[0];this.currentItem=this.items[1];this.nextItem=this.items[2]},addListeners:function(){for(var d=0;d<this.items.length;d++){var e=this.items[d];e.addListener(b.EventTypes.onFullSizeImageLoadAnomaly,this.sliderFullSizeImageLoadAnomalyEventHandler)}},removeListeners:function(){for(var d=0;d<this.items.length;d++){var e=this.items[d];e.removeListener(b.EventTypes.onFullSizeImageLoadAnomaly,this.sliderFullSizeImageLoadAnomalyEventHandler)}},resetPosition:function(){c.DOM.show(this.currentItem.imageContainerEl);this.parentElWidth=c.DOM.width(this.parentEl);this.parentElHeight=c.DOM.height(this.parentEl);c.DOM.width(this.el,this.parentElWidth*3);c.DOM.height(this.el,this.parentElHeight);this.previousItem.resetPosition(this.parentElWidth,this.parentElHeight,0);this.currentItem.resetPosition(this.parentElWidth,this.parentElHeight,this.parentElWidth);this.nextItem.resetPosition(this.parentElWidth,this.parentElHeight,this.parentElWidth*2);this.center()},center:function(){c.DOM.resetTranslate(this.el);c.DOM.setStyle(this.el,{left:(this.parentElWidth*-1)+"px"})},setCurrentFullSizeImage:function(d){this.currentItem.setFullSizeImage(d);this.dispatchDisplayCurrentFullSizeImage()},setPreviousAndNextFullSizeImages:function(e,d){this.nextItem.setFullSizeImage(d);this.previousItem.setFullSizeImage(e)},onBounceStepOne:function(d){c.Animation.slideBy(this.el,(this.lastShowAction===Pda.ps.SliderClass.ShowActionTypes.previous)?this.bounceSlideBy*-1:this.bounceSlideBy,0,this.settings.slideSpeed,this.bounceStepTwoEventHandler)},onBounceStepTwo:function(d){this.dispatchDisplayCurrentFullSizeImage()},onShowNextEnd:function(){c.DOM.show(this.currentItem.imageContainerEl);c.swapArrayElements(this.items,1,2);this.currentItem=this.items[1];this.nextItem=this.items[2];var d=this.parentElWidth;c.DOM.setStyle(this.currentItem.el,"left",d+"px");c.DOM.setStyle(this.nextItem.el,"left",(d*2)+"px");this.center();this.dispatchDisplayCurrentFullSizeImage()},onShowPreviousEnd:function(){c.DOM.show(this.currentItem.imageContainerEl);c.swapArrayElements(this.items,1,0);this.currentItem=this.items[1];this.previousItem=this.items[0];c.DOM.setStyle(this.currentItem.el,"left",this.parentElWidth+"px");c.DOM.setStyle(this.previousItem.el,"left","0px");this.center();this.dispatchDisplayCurrentFullSizeImage()},onSliderFullSizeImageLoadAnomaly:function(f){var d=f.fullSizeImage;if(!c.isNothing(this.currentItem.fullSizeImage)){if(this.currentItem.fullSizeImage.index===d.index){this.currentItem.setFullSizeImage(d);this.dispatchDisplayCurrentFullSizeImage();return}}if(!c.isNothing(this.nextItem.fullSizeImage)){if(this.nextItem.fullSizeImage.index===d.index){this.nextItem.setFullSizeImage(d);return}}if(!c.isNothing(this.previousItem.fullSizeImage)){if(this.previousItem.fullSizeImage.index===d.index){this.previousItem.setFullSizeImage(d);return}}},showNext:function(){this.lastShowAction=Pda.ps.SliderClass.ShowActionTypes.next;this.hasBounced=false;if(c.isNothing(this.nextItem.fullSizeImage)){this.bounce();return}var d=this.parentElWidth*-1;c.Animation.slideBy(this.el,d,0,this.settings.slideSpeed,this.showNextEndEventHandler)},showPrevious:function(){this.lastShowAction=Pda.ps.SliderClass.ShowActionTypes.previous;this.hasBounced=false;if(c.isNothing(this.previousItem.fullSizeImage)){this.bounce();return}var d=this.parentElWidth;c.Animation.slideBy(this.el,d,0,this.settings.slideSpeed,this.showPreviousEndEventHandler)},bounce:function(){c.DOM.show(this.currentItem.imageContainerEl);this.hasBounced=true;this.bounceSlideBy=this.parentElWidth/2;c.Animation.slideBy(this.el,(this.lastShowAction===Pda.ps.SliderClass.ShowActionTypes.previous)?this.bounceSlideBy:this.bounceSlideBy*-1,0,this.settings.slideSpeed,this.bounceStepOneEventHandler)},dispatchDisplayCurrentFullSizeImage:function(){this.dispatchEvent({type:Pda.ps.SliderClass.EventTypes.onFullImageHandler,target:this,fullSizeImage:this.currentItem.fullSizeImage})}});Pda.ps.SliderClass.ShowActionTypes={next:"next",previous:"previous"};Pda.ps.SliderClass.EventTypes={onFullImageHandler:"onFullImageHandler"}})(window,Pda.ps.Util,Pda.ps.SliderItemClass);(function(a,b){Pda.ps.CaptionClass=Pda.ps.ElementClass.extend({contentEl:null,touchMoveHandler:null,captionValue:null,init:function(d){this.settings={position:"top",zIndex:1000};b.extend(this.settings,d);this._super(this.settings);this.captionValue="";this.touchMoveHandler=this.onTouchMove.bind(this);var c="ps-caption";if(this.settings.position==="bottom"){c=c+" ps-caption-bottom"}this.el=b.DOM.createElement("div",{"class":c},"");b.DOM.setStyle(this.el,{left:0,position:"absolute",overflow:"hidden",zIndex:this.settings.zIndex,opacity:0});b.DOM.hide(this.el);b.DOM.appendToBody(this.el);this.contentEl=b.DOM.createElement("div",{"class":"ps-caption-content"},"");b.DOM.appendChild(this.contentEl,this.el)},addListeners:function(){b.DOM.addListener(this.el,"touchmove",this.touchMoveHandler)},removeListeners:function(){b.DOM.removeListener(this.el,"touchmove",this.touchMoveHandler)},onTouchMove:function(c){c.preventDefault()},resetPosition:function(){var c;if(this.settings.position==="bottom"){c=b.DOM.windowHeight()-b.DOM.height(this.el)+b.DOM.windowScrollTop()}else{c=b.DOM.windowScrollTop()}b.DOM.setStyle(this.el,"top",c+"px");b.DOM.width(this.el,b.DOM.bodyWidth())},setCaptionValue:function(c){b.DOM.removeChildren(this.contentEl);c=b.coalesce(c,"\u00A0");if(b.isObject(c)){b.DOM.appendChild(c,this.contentEl)}else{if(c===""){c="\u00A0"}$(this.contentEl).text(c)}this.captionValue=(c==="\u00A0")?"":c}})})(window,Pda.ps.Util);(function(a,b){Pda.ps.ToolbarClass=Pda.ps.ElementClass.extend({closeEl:null,previousEl:null,nextEl:null,playEl:null,clickHandler:null,touchStartHandler:null,touchMoveHandler:null,touched:null,isNextActive:null,isPreviousActive:null,attId:null,init:function(d){this.settings={position:"bottom",hideClose:false,zIndex:1000};b.extend(this.settings,d);this._super(this.settings);this.isNextActive=true;this.isPreviousActive=true;this.touched=false;this.clickHandler=this.onClick.bind(this);this.touchMoveHandler=this.onTouchMove.bind(this);this.touchStartHandler=this.onTouchStart.bind(this);var c=Pda.ps.ToolbarClass.CssClasses.caption;if(this.settings.position==="top"){c=c+" "+Pda.ps.ToolbarClass.CssClasses.top}this.el=b.DOM.createElement("div",{"class":c},"");b.DOM.setStyle(this.el,{left:0,position:"absolute",overflow:"hidden",zIndex:this.settings.zIndex,display:"table",opacity:0});b.DOM.hide(this.el);b.DOM.appendToBody(this.el);this.closeEl=b.DOM.createElement("div",{"class":Pda.ps.ToolbarClass.CssClasses.close},'<div class="'+Pda.ps.ToolbarClass.CssClasses.content+'"></div>');if(this.settings.hideClose){b.DOM.hide(this.closeEl)}b.DOM.appendChild(this.closeEl,this.el);this.playEl=b.DOM.createElement("div",{"class":Pda.ps.ToolbarClass.CssClasses.play},'<div class="'+Pda.ps.ToolbarClass.CssClasses.content+'"></div>');b.DOM.appendChild(this.playEl,this.el)},postFadeIn:function(c){if(this.isHidden){return}b.DOM.setStyle(this.el,{display:"table"});this._super(this.settings)},addListeners:function(){b.DOM.addListener(this.el,"touchmove",this.touchMoveHandler);b.DOM.addListener(this.el,"click",this.clickHandler)},removeListeners:function(){b.DOM.removeListener(this.el,"touchmove",this.touchMoveHandler);b.DOM.removeListener(this.el,"click",this.clickHandler)},onTouchStart:function(c){c.preventDefault();this.touched=true;this.handleClick(c)},onTouchMove:function(c){c.preventDefault()},onClick:function(c){if(this.touched){return}this.handleClick(c)},handleClick:function(d){var c;switch(d.target.parentNode){case this.playEl:c=Pda.ps.ToolbarClass.Actions.play;break;case this.closeEl:c=Pda.ps.ToolbarClass.Actions.close;break}if(b.isNothing(c)){return}this.dispatchEvent({type:Pda.ps.ToolbarClass.EventTypes.onClick,target:this,action:c})},resetPosition:function(){var c;if(this.settings.position==="bottom"){c=b.DOM.windowHeight()-b.DOM.height(this.el)+b.DOM.windowScrollTop()}else{c=b.DOM.windowScrollTop()}b.DOM.setStyle(this.el,"top",c+"px");b.DOM.width(this.el,b.DOM.bodyWidth())},setNextState:function(c){if(c){b.DOM.addClass(this.nextEl,Pda.ps.ToolbarClass.CssClasses.nextDisabled);this.isNextActive=false}else{b.DOM.removeClass(this.nextEl,Pda.ps.ToolbarClass.CssClasses.nextDisabled);this.isNextActive=true}},setPreviousState:function(c){if(c){b.DOM.addClass(this.previousEl,Pda.ps.ToolbarClass.CssClasses.previousDisabled);this.isPreviousActive=false}else{b.DOM.removeClass(this.previousEl,Pda.ps.ToolbarClass.CssClasses.previousDisabled);this.isPreviousActive=true}},setPlayValue:function(c){this.attId=c}});Pda.ps.ToolbarClass.CssClasses={caption:"ps-toolbar",top:"ps-toolbar-top",close:"ps-toolbar-close",previousDisabled:"ps-toolbar-previous-disabled",nextDisabled:"ps-toolbar-next-disabled",play:"ps-toolbar-play",content:"ps-toolbar-content"};Pda.ps.ToolbarClass.Actions={close:"close",play:"play"};Pda.ps.ToolbarClass.EventTypes={onClick:"onClick"}})(window,Pda.ps.Util);(function(b,d,c,a){Pda.ps.CaptionToolbarClass=Pda.ps.EventClass.extend({toolbar:null,caption:null,isHidden:null,hasAddedEventListeners:null,toolbarClickEventHandler:null,init:function(e){this._super();this.settings={opacity:0.8,fadeInSpeed:250,fadeOutSpeed:500,autoHideDelay:5000,hideClose:false,zIndex:1000};d.extend(this.settings,e);this.isHidden=true;this.hasAddedEventListeners=false;this.toolbarClickEventHandler=this.onToolbarClick.bind(this);this.caption=new c({fadeInSpeed:this.settings.fadeInSpeed,fadeOutSpeed:this.settings.fadeOutSpeed,opacity:this.settings.opacity,position:"top",zIndex:this.settings.zIndex});this.toolbar=new a({fadeInSpeed:this.settings.fadeInSpeed,fadeOutSpeed:this.settings.fadeOutSpeed,opacity:this.settings.opacity,position:"bottom",hideClose:this.settings.hideClose,zIndex:this.settings.zIndex+1})},resetPosition:function(){this.caption.resetPosition();this.toolbar.resetPosition()},addListeners:function(){if(this.hasAddedEventListeners){return}this.toolbar.addListener(a.EventTypes.onClick,this.toolbarClickEventHandler);this.hasAddedEventListeners=true},removeListeners:function(){this.toolbar.removeListener(a.EventTypes.onClick,this.toolbarClickEventHandler);this.hasAddedEventListeners=false},fadeIn:function(){this.stopAutoHideTimeout();if(this.isHidden){this.isHidden=false;this.fadeInCaption();this.toolbar.fadeIn();b.setTimeout(this.onFadeIn.bind(this),this.settings.fadeInSpeed)}else{if(this.caption.isHidden){this.fadeInCaption()}this.resetAutoHideTimeout()}},showCaption:function(){if(this.caption.captionValue===""){this.caption.show()}else{this.caption.show()}},fadeInCaption:function(){if(this.caption.captionValue===""){this.caption.fadeIn()}else{this.caption.fadeIn()}},onFadeIn:function(){this.addListeners();this.resetAutoHideTimeout()},fadeOut:function(){this.stopAutoHideTimeout();this.isHidden=true;this.caption.fadeOut();this.toolbar.fadeOut();b.setTimeout(this.onFadeOut.bind(this),this.settings.fadeOutSpeed)},onFadeOut:function(){},hide:function(){this.stopAutoHideTimeout();this.isHidden=true;this.removeListeners();this.caption.hide();this.toolbar.hide()},setCaptionValue:function(e){this.caption.setCaptionValue(e);if(this.caption.captionValue===""){this.caption.fadeOut()}},setPlayValue:function(e){this.toolbar.setPlayValue(e)},resetAutoHideTimeout:function(){if(this.isHidden){return}this.stopAutoHideTimeout();if(this.settings.autoHideDelay>0){this.autoHideTimeout=b.setTimeout(this.fadeOut.bind(this),this.settings.autoHideDelay)}},stopAutoHideTimeout:function(){if(!d.isNothing(this.autoHideTimeout)){b.clearTimeout(this.autoHideTimeout)}},onToolbarClick:function(f){this.dispatchEvent({type:Pda.ps.ToolbarClass.EventTypes.onClick,target:this,action:f.action})},setNextState:function(e){this.toolbar.setNextState(e)},setPreviousState:function(e){this.toolbar.setPreviousState(e)}})})(window,Pda.ps.Util,Pda.ps.CaptionClass,Pda.ps.ToolbarClass);(function(h,j,g,d,a,e,k,c,i,f){var b=Pda.ps.EventClass.extend({fullSizeImages:null,documentOverlay:null,viewport:null,slider:null,captionAndToolbar:null,zoomPanRotate:null,settings:null,currentIndex:null,isBusy:null,isActive:null,slideshowTimeout:null,isSlideshowActive:null,lastShowPrevTrigger:null,viewportFadeInEventHandler:null,windowOrientationChangeEventHandler:null,windowScrollEventHandler:null,viewportTouchEventHandler:null,viewportFadeOutEventHandler:null,fullImageHandler:null,toolbarClickEventHandler:null,orientationEventName:null,init:function(){this._super();this.currentIndex=0;this.isBusy=false;this.isActive=false;this.isSlideshowActive=false;this.settings={getImageSource:Pda.ps.GetImageSource,getImageCaption:Pda.ps.GetImageCaption,getImageMetaData:Pda.ps.GetImageMetaData,fadeInSpeed:250,fadeOutSpeed:500,slideSpeed:250,swipeThreshold:50,swipeTimeThreshold:250,loop:true,slideshowDelay:3000,imageScaleMethod:"fit",preventHide:false,zIndex:1000,backButtonHideEnabled:true,allowUserZoom:true,allowRotationOnUserZoom:true,maxUserZoom:5,minUserZoom:0.5,adjustUserPanToZoom:true,captionAndToolbarHide:false,captionAndToolbarHideOnSwipe:true,captionAndToolbarAutoHideDelay:5000,captionAndToolbarOpacity:0.8};if(this.settings.preventHide){this.settings.backButtonHideEnabled=false}this.viewportFadeInEventHandler=this.onViewportFadeIn.bind(this);this.windowOrientationChangeEventHandler=this.onWindowOrientationChange.bind(this);this.windowScrollEventHandler=this.onWindowScroll.bind(this);this.viewportTouchEventHandler=this.onViewportTouch.bind(this);this.viewportFadeOutEventHandler=this.onViewportFadeOut.bind(this);this.fullImageHandler=this.onSliderDisplayCurrentFullSizeImage.bind(this);this.toolbarClickEventHandler=this.onToolbarClick.bind(this)},setOptions:function(l){j.extend(this.settings,l);if(this.settings.preventHide){this.settings.backButtonHideEnabled=false}},setImages:function(l){this.currentIndex=0;this.fullSizeImages=[];for(var m=0;m<l.length;m++){var o=l[m];var n=new a(m,this.settings.imageScaleMethod,this.settings.getImageSource(o),this.settings.getImageCaption(o),this.settings.getImageMetaData(o));this.fullSizeImages.push(n)}},show:function(l){if(this.isBusy||this.isActive){return}this.isActive=true;this.isBusy=true;this.lastShowPrevTrigger=Pda.ps.ShowPrevTriggers.show;j.DOM.addClass(document.body,Pda.ps.CssClasses.activeBody);l=h.parseInt(l);if(l<0||l>=this.fullSizeImages.length){l=0}this.currentIndex=l;if(j.isNothing(this.documentOverlay)){this.build()}else{this.resetPosition()}this.viewport.addListener(g.EventTypes.onFadeIn,this.viewportFadeInEventHandler);this.dispatchEvent(Pda.ps.EventTypes.onBeforeShow);this.viewport.fadeIn()},build:function(){this.documentOverlay=new d({fadeInSpeed:this.settings.fadeInSpeed,fadeOutSpeed:this.settings.fadeOutSpeed,zIndex:this.settings.zIndex});this.viewport=new e({fadeInSpeed:this.settings.fadeInSpeed,fadeOutSpeed:this.settings.fadeOutSpeed,swipeThreshold:this.settings.swipeThreshold,swipeTimeThreshold:this.settings.swipeTimeThreshold,zIndex:this.settings.zIndex+1});this.slider=new k({fadeInSpeed:this.settings.fadeInSpeed,fadeOutSpeed:this.settings.fadeOutSpeed,slideSpeed:this.settings.slideSpeed},this.viewport.el);this.captionAndToolbar=new f({opacity:this.settings.captionAndToolbarOpacity,fadeInSpeed:this.settings.fadeInSpeed,fadeOutSpeed:this.settings.fadeOutSpeed,autoHideDelay:this.settings.captionAndToolbarAutoHideDelay,hideClose:this.settings.preventHide,zIndex:this.settings.zIndex+3});this.resetPosition()},addListeners:function(){if(j.browser.isAndroid){this.orientationEventName="resize"}else{var l="onorientationchange" in h;this.orientationEventName=l?"orientationchange":"resize"}j.DOM.addListener(h,this.orientationEventName,this.windowOrientationChangeEventHandler);j.DOM.addListener(h,"scroll",this.windowScrollEventHandler);this.viewport.addListener(e.EventTypes.onTouch,this.viewportTouchEventHandler);this.slider.addListener(k.EventTypes.onFullImageHandler,this.fullImageHandler);this.captionAndToolbar.addListener(i.EventTypes.onClick,this.toolbarClickEventHandler)},removeListeners:function(){j.DOM.removeListener(h,this.orientationEventName,this.windowOrientationChangeEventHandler);j.DOM.removeListener(h,"scroll",this.windowScrollEventHandler);this.viewport.removeListener(e.EventTypes.onTouch,this.viewportTouchEventHandler);this.slider.removeListener(k.EventTypes.onFullImageHandler,this.fullImageHandler);this.captionAndToolbar.removeListener(i.EventTypes.onClick,this.toolbarClickEventHandler)},onViewportFadeIn:function(l){this.viewport.removeListener(g.EventTypes.onFadeIn,this.viewportFadeInEventHandler);this.documentOverlay.show();this.slider.fadeIn();this.addListeners();this.slider.setCurrentFullSizeImage(this.fullSizeImages[this.currentIndex]);this.isBusy=false;this.dispatchEvent(Pda.ps.EventTypes.onShow)},setSliderPreviousAndNextFullSizeImages:function(){var n,m=null,l=null;if(this.fullSizeImages.length>1){n=this.fullSizeImages.length-1;if(this.currentIndex===n){if(this.settings.loop){l=this.fullSizeImages[0]}m=this.fullSizeImages[this.currentIndex-1]}else{if(this.currentIndex===0){l=this.fullSizeImages[this.currentIndex+1];if(this.settings.loop){m=this.fullSizeImages[n]}}else{l=this.fullSizeImages[this.currentIndex+1];m=this.fullSizeImages[this.currentIndex-1]}}}this.slider.setPreviousAndNextFullSizeImages(m,l)},onWindowOrientationChange:function(l){this.resetPosition()},onWindowScroll:function(l){this.resetPosition()},resetPosition:function(){this.removeZoomPanRotate();this.viewport.resetPosition();this.slider.resetPosition();this.documentOverlay.resetPosition();this.captionAndToolbar.resetPosition();this.dispatchEvent(Pda.ps.EventTypes.onResetPosition)},onViewportTouch:function(l){switch(l.action){case e.Actions.touchStart:this.stopSlideshow();break;case e.Actions.touchMove:break;case e.Actions.click:this.stopSlideshow();if(!this.settings.hideToolbar){this.toggleCaptionAndToolbar()}else{this.hide()}this.dispatchEvent(Pda.ps.EventTypes.onViewportClick);break;case e.Actions.swipeLeft:this.stopSlideshow();this.lastShowPrevTrigger=Pda.ps.ShowPrevTriggers.swipe;this.showNext();break;case e.Actions.swipeRight:this.stopSlideshow();this.lastShowPrevTrigger=Pda.ps.ShowPrevTriggers.swipe;this.showPrevious();break}},onViewportFadeOut:function(l){this.viewport.removeListener(g.EventTypes.onFadeOut,this.viewportFadeOutEventHandler);this.isBusy=false;this.isActive=false;this.dispatchEvent(Pda.ps.EventTypes.onHide)},hide:function(){if(this.isBusy||this.settings.preventHide){return}if(!this.isActive){return}this.isBusy=true;this.removeZoomPanRotate();this.removeListeners();this.documentOverlay.hide();this.captionAndToolbar.hide();this.slider.hide();j.DOM.removeClass(document.body,Pda.ps.CssClasses.activeBody);this.viewport.addListener(g.EventTypes.onFadeOut,this.viewportFadeOutEventHandler);this.dispatchEvent(Pda.ps.EventTypes.onBeforeHide);this.viewport.fadeOut()},hideImmediately:function(){if(!this.isActive){return}this.dispatchEvent(Pda.ps.EventTypes.onBeforeHide);this.removeZoomPanRotate();this.removeListeners();this.documentOverlay.hide();this.captionAndToolbar.hide();this.slider.hide();this.viewport.hide();j.DOM.removeClass(document.body,Pda.ps.CssClasses.activeBody);this.isBusy=false;this.isActive=false;this.dispatchEvent(Pda.ps.EventTypes.onHide)},showNext:function(){if(this.isBusy){return}this.isBusy=true;this.setCaptionAndToolbarOnShowPreviousNext();this.slider.showNext();this.dispatchEvent(Pda.ps.EventTypes.onShowNext)},showPrevious:function(){if(this.isBusy){return}this.isBusy=true;this.setCaptionAndToolbarOnShowPreviousNext();if(this.wasUserZoomActive){j.DOM.hide(this.slider.currentItem.imageEl)}this.slider.showPrevious();this.dispatchEvent(Pda.ps.EventTypes.onShowPrevious)},setCaptionAndToolbarOnShowPreviousNext:function(){if(this.settings.captionAndToolbarHide){return}var l=false;switch(this.lastShowPrevTrigger){case Pda.ps.ShowPrevTriggers.toolbar:l=true;break;case Pda.ps.ShowPrevTriggers.slideshow:l=false;break;default:l=!this.settings.captionAndToolbarHideOnSwipe;break}if(l){this.captionAndToolbar.resetAutoHideTimeout()}else{this.fadeOutCaptionAndToolbar()}},onSliderDisplayCurrentFullSizeImage:function(m){this.currentIndex=m.fullSizeImage.index;if(!this.settings.captionAndToolbarHide){if(this.settings.loop){this.captionAndToolbar.setNextState(false);this.captionAndToolbar.setPreviousState(false)}else{if(this.currentIndex>=this.fullSizeImages.length-1){this.captionAndToolbar.setNextState(true)}else{this.captionAndToolbar.setNextState(false)}if(this.currentIndex<1){this.captionAndToolbar.setPreviousState(true)}else{this.captionAndToolbar.setPreviousState(false)}}this.captionAndToolbar.setCaptionValue(this.fullSizeImages[this.currentIndex].caption);this.captionAndToolbar.setPlayValue(this.fullSizeImages[this.currentIndex].metaData.id);var l=false;switch(this.lastShowPrevTrigger){case Pda.ps.ShowPrevTriggers.toolbar:l=true;break;case Pda.ps.ShowPrevTriggers.show:l=true;break;case Pda.ps.ShowPrevTriggers.slideshow:l=false;break;default:l=!this.settings.captionAndToolbarHideOnSwipe;break}if(l){this.dispatchEvent(Pda.ps.EventTypes.onBeforeCaptionAndToolbarShow);this.captionAndToolbar.fadeIn()}this.dispatchEvent(Pda.ps.EventTypes.onDisplayImage)}this.lastShowPrevTrigger="";this.setSliderPreviousAndNextFullSizeImages();this.isBusy=false},toggleCaptionAndToolbar:function(){if(this.settings.captionAndToolbarHide){this.captionAndToolbar.hide();return}if(this.captionAndToolbar.isHidden){this.dispatchEvent(Pda.ps.EventTypes.onBeforeCaptionAndToolbarShow);this.captionAndToolbar.fadeIn()}else{this.dispatchEvent(Pda.ps.EventTypes.onBeforeCaptionAndToolbarHide);this.captionAndToolbar.fadeOut()}},fadeOutCaptionAndToolbar:function(){if(!this.settings.captionAndToolbarHide&&!this.captionAndToolbar.isHidden){this.dispatchEvent(Pda.ps.EventTypes.onBeforeCaptionAndToolbarHide);this.captionAndToolbar.fadeOut()}},onToolbarClick:function(l){this.stopSlideshow();switch(l.action){case i.Actions.play:this.play();break;default:this.hide();break}},play:function(){h.open(Com_Parameter.ContextPath+"/sys/attachment/sys_att_main/sysAttMain.do?method=download&fdId="+this.captionAndToolbar.toolbar.attId,"_blank")},stopSlideshow:function(){if(!j.isNothing(this.slideshowTimeout)){h.clearTimeout(this.slideshowTimeout)}this.isSlideshowActive=false;this.dispatchEvent(Pda.ps.EventTypes.onSlideshowStop)},removeZoomPanRotate:function(){if(j.isNothing(this.zoomPanRotate)){return}this.zoomPanRotate.removeFromDOM();this.zoomPanRotate=null}});Pda.ps.CssClasses={activeBody:"ps-active"};Pda.ps.ShowPrevTriggers={show:"show",toolbar:"toobar",swipe:"swipe",keyboard:"keyboard",slideshow:"slideshow"};Pda.ps.EventTypes={onBeforeShow:"onBeforeShow",onShow:"onShow",onBeforeHide:"onBeforeHide",onHide:"onHide",onShowNext:"onShowNext",onShowPrevious:"onShowPrevious",onDisplayImage:"onDisplayImage",onResetPosition:"onResetPosition",onSlideshowStart:"onSlideshowStart",onSlideshowStop:"onSlideshowStop",onBeforeCaptionAndToolbarShow:"onBeforeCaptionAndToolbarShow",onBeforeCaptionAndToolbarHide:"onBeforeCaptionAndToolbarHide",onViewportClick:"onViewportClick"};Pda.ps.GetImageSource=function(l){return l.href};Pda.ps.GetImageCaption=function(n){if(n.nodeName==="IMG"){return $(n).attr("alt")}var m,l;for(m=0;m<n.childNodes.length;m++){l=n.childNodes[m];if(n.childNodes[m].nodeName==="IMG"){return $(l).attr("alt")}}};Pda.ps.GetImageMetaData=function(n){if(n.nodeName==="IMG"){return{id:$(l).attr("data-lui-id")}}var m,l;for(m=0;m<n.childNodes.length;m++){l=n.childNodes[m];if(n.childNodes[m].nodeName==="IMG"){return{id:$(l).attr("data-lui-id")}}}};Pda.ps.Current=new b();Pda.photoSwipe=function(l,q,o){var m=true;if(j.isNothing(l)){return}if(j.isNothing(q)){q=document.documentElement;m=false}if(j.isString(q)){q=document.documentElement.querySelector(q)}if(j.isString(l)){l=q.querySelectorAll(l)}if(j.isNothing(l)){return}var s=function(t){t.preventDefault();r(t.currentTarget)};var r=function(t){var u;for(u=0;u<l.length;u++){if(l[u]===t){break}}Pda.ps.Current.show(u)};Pda.ps.Current.setOptions(o);Pda.ps.Current.setImages(l);if(m){q.addListener("click",function(v){if(v.target===v.currentTarget){return}v.preventDefault();var u=function(x,w,y){if(j.isNothing(x)||j.isNothing(w)||j.isNothing(y)){return null}if(x.nodeName===w){return x}if(x===y){return null}return u(x.parentNode,w,y)};var t=u(v.target,l[0].nodeName,v.currentTarget);if(j.isNothing(t)){return}r(t)},false)}else{for(var n=0;n<l.length;n++){var p=l[n];p.addListener("click",s,false)}}return l};if(!j.isNothing(h.$)){h.$.fn.photoSwipe=function(m){var l=this;Pda.ps.Current.setOptions(m);Pda.ps.Current.setImages(l);$(l).on("click",function(o){o.preventDefault();var n=$(l).index($(o.currentTarget));Pda.ps.Current.show(n)})}}})(window,Pda.ps.Util,Pda.ps.ElementClass,Pda.ps.DocumentOverlayClass,Pda.ps.FullSizeImageClass,Pda.ps.ViewportClass,Pda.ps.SliderClass,Pda.ps.CaptionClass,Pda.ps.ToolbarClass,Pda.ps.CaptionToolbarClass);